
data data12;
call code code code code;
run;

proc sql data1;
create table data100;
select code code code code;
from; (select /*+full(a) paralle(a4)*/
code code code code count(*) as code from data2);
where code = 'value1' 
and; (select code from data3 where code = value2 and code in (code))
group by code code code
left join data123
on code = code
where code in (select code from data12 where code = code and code in (str(1,2)))
order by code code code
end;
run;

proc print data1;
var code code code code;
run;
